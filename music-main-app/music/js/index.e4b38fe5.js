"use strict";(self["webpackChunkvue_test"]=self["webpackChunkvue_test"]||[]).push([[826],{8804:function(e,t,i){i.r(t),i.d(t,{default:function(){return M}});var s=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"title",rawName:"v-title"}],attrs:{"data-title":"音乐之家"}},[t("el-container",[t("el-main",{staticClass:"me-articles"},[t("music-scroll-page")],1)],1)],1)},a=[],n=function(){var e=this,t=e._self._c;return t("scroll-page",{attrs:{loading:e.loading,offset:e.offset,"no-data":e.noData},on:{load:e.load}},e._l(e.musics,(function(i){return t("music-item",e._b({key:i.id},"music-item",i,!1))})),1)},l=[],r=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"me-area",attrs:{"body-style":{padding:"16px"}}},[t("div",{staticClass:"me-article-header"},[t("a",{staticClass:"me-article-title",attrs:{href:e.singFileName}},[e._v(e._s(e.title))]),e.weight>0?t("el-button",{staticClass:"me-article-icon",attrs:{type:"text"}},[e._v("置顶")]):e._e(),t("span",{staticClass:"me-pull-right me-article-count"},[t("i",{staticClass:"el-icon-view"}),e._v(" "+e._s(e.loadCounts)+" ")])],1),t("div",{staticClass:"me-article-footer"},[t("span",{staticClass:"me-article-author"},[t("i",{staticClass:"me-icon-author"}),e._v(" "+e._s(e.singer)+" ")]),t("span",{staticClass:"me-pull-right me-article-count"},[t("i",{staticClass:"el-icon-time"}),e._v(" "+e._s(e.createDate)+" ")])])])},o=[],c={name:"MusicItem",props:{id:String,weight:Number,title:String,loadCounts:Number,singer:String,createDate:String},data(){return{}},computed:{singFileName(){return"http://124.220.15.95:8888/download/"+this.id+".mp3"}}},d=c,u=i(1001),g=(0,u.Z)(d,r,o,!1,null,"392a5b1a",null),m=g.exports,p=function(){var e=this,t=e._self._c;return t("div",{ref:"scroll",staticStyle:{overflow:"hidden"},attrs:{id:"scroll-page"}},[e._t("default"),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{height:"40px","margin-top":"10px","z-index":"1"},attrs:{"element-loading-text":"拼命加载中~","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(245,245,245)"}})],2)},f=[],h={props:{loading:Boolean,noData:Boolean,offset:Number},name:"ScrollPage",mounted(){window.addEventListener("scroll",this.handleScroll,!1)},beforeDestroy(){window.removeEventListener("scroll",this.handleScroll)},data(){return{scrollAction:{x:"undefined",y:"undefined"}}},methods:{handleScroll(e){var t=this;if(!t.noData){let e=document.documentElement.scrollTop||document.body.scrollTop;document.getElementById("scroll-page");e+window.innerHeight>=t.$refs.scroll.offsetHeight+t.offset&&t.isDownDirection()&&(t.loading||t.$emit("load"))}},isDownDirection(){"undefined"==typeof this.scrollAction.x&&(this.scrollAction.x=window.pageXOffset,this.scrollAction.y=window.pageYOffset);var e=this.scrollAction.x-window.pageXOffset,t=this.scrollAction.y-window.pageYOffset;if(this.scrollAction.x=window.pageXOffset,this.scrollAction.y=window.pageYOffset,e<0);else if(e>0);else if(t<0)return!0;return!1}}},w=h,v=(0,u.Z)(w,p,f,!1,null,"16bc1d3c",null),_=v.exports,b=i(7344);function y(e,t){return(0,b.Z)({url:"/musics",method:"post",data:{page:t.pageNumber,pageSize:t.pageSize}})}var x={name:"MusicScrollPage",props:{offset:{type:Number,default:100},page:{type:Object,default(){return{}}},query:{type:Object,default(){return{}}}},watch:{query:{handler(){this.noData=!1,this.musics=[],this.innerPage.pageNumber=1,this.getMusics()},deep:!0},page:{handler(){this.noData=!1,this.musics=[],this.innerPage=this.page,this.getMusics()},deep:!0}},created(){this.getMusics()},data(){return{loading:!1,noData:!1,innerPage:{pageSize:5,pageNumber:1},musics:[]}},methods:{load(){this.getMusics()},getMusics(){let e=this;e.loading=!0,y(e.query,e.innerPage).then((t=>{let i=t.data;i&&i.length>0?(e.innerPage.pageNumber+=1,e.musics=e.musics.concat(i)):e.noData=!0})).catch((t=>{"error"!==t&&e.$message({type:"error",message:"歌曲加载失败!",showClose:!0})})).finally((()=>{e.loading=!1}))}},components:{"music-item":m,"scroll-page":_}},C=x,D=(0,u.Z)(C,n,l,!1,null,"2626773b",null),S=D.exports,N={name:"Index",components:{"music-scroll-page":S}},A=N,O=(0,u.Z)(A,s,a,!1,null,"482d7962",null),M=O.exports}}]);
//# sourceMappingURL=index.e4b38fe5.js.map